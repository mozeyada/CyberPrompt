#
# Configuration stanzas from SA-bots
#
[top]
FIELDALIAS-process = COMMAND as process
FIELDALIAS-process_name = COMMAND as process_name
FIELDALIAS-user = USER as user
FIELDALIAS-dest = host as dest

[osquery_results]
## For general
FIELDALIAS-user = decorations.username as user
FIELDALIAS-dest = host as dest
EVAL-vendor_product = "osquery"

## For processes
FIELDALIAS-process = columns.path as process
FIELDALIAS-process_name = columns.name as process_name

## For file_events
EVAL-object_category = if(name="file_events", "file", null)
FIELDALIAS-file_path = columns.target_path as file_path
FIELDALIAS-file_access_time = columns.atime as file_access_time
FIELDALIAS-file_create_time = columns.ctime as file_create_time
FIELDALIAS-file_size = columns.size as file_size
FIELDALIAS-file_acl = columns.mode as file_acl
#FIELDALIAS- =  as
EVAL-file_hash = mvfilter(mvappend(mvappend(coalesce('columns.md5', ""), coalesce('columns.sha1', "")),coalesce('columns.sha256', "")))
EVAL-file_name = replace(file_path, "^.*[\\/]", "")


#
# Configuration stanzas Splunk_TA_BOTS
#
[iis]
REPORT-iis = iis_extractions
LOOKUP-iis_action_lookup = iis_action_lookup status OUTPUT action
FIELDALIAS-cs_username = cs_username as user
FIELDALIAS-cs_User_Agent = cs_User_Agent as http_user_agent,cs_User_Agent_ as http_user_agent
FIELDALIAS-cs_uri_stem = cs_uri_stem as uri_path
FIELDALIAS-cs_uri_query = cs_uri_query as uri_query
FIELDALIAS-TimeTakenMS = TimeTakenMS as duration, TimeTakenMS as response_time, time_taken as duration, time_taken as response_time
FIELDALIAS-sc_status = sc_status as status
FIELDALIAS-s_sitename = s_sitename as site
FIELDALIAS-s_ip = s_ip as dest_ip, s_ip as dest, s_ip as dvc
FIELDALIAS-s_port = s_port as http_port, s_port as dest_port, s_port as port
FIELDALIAS-s_computername = s_computername as host
FIELDALIAS-RequestsPerSecond = RequestsPerSecond as hits_per_second
FIELDALIAS-cs_Referer = cs_Referer as http_referrer, cs_Referer_ as http_referrer, cs_Referer as http_referer, cs_Referer_ as http_referer
FIELDALIAS-cs_method = cs_method as http_method
FIELDALIAS-cs_Cookie = cs_Cookie as cookie, cs_Cookie_ as cookie
FIELDALIAS-c_ip = c_ip as src_ip, c_ip as src
FIELDALIAS-sc_bytes = sc_bytes as bytes_out
FIELDALIAS-cs_bytes = cs_bytes as bytes_in
EVAL-http_user_agent_length = len(http_user_agent)
EVAL-bytes = bytes_in + bytes_out
#EVAL-web_server = host . ":" . site
EVAL-vendor = "Microsoft"
EVAL-product = "Internet Information Services (IIS)"
EVAL-vendor_product = "Microsoft Internet Information Services (IIS)"
EVAL-app = "Microsoft Internet Information Services (IIS)"
EVAL-url = "http://". s_ip . ":" . s_port . cs_uri_stem . if((cs_uri_query =="-"), "", "?" + cs_uri_query)
#EVAL-url = "http://". s_ip . ":" . s_port . cs_uri_stem . if(isnull(cs_uri_query) OR (cs_uri_query =="-"), "", "?" + cs_uri_query)
EVAL-url_length = len(url)
EVAL-role = "web_server"
pulldown_type = true
description = Log files produced by Microsoft IIS W3C log files (index-time field extraction)
category = Web


# rewrite the host field at indextime
[WinEventLog:Security]
TRANSFORMS-WINEVENTLOG1 = WINLOG_set_host
[WinEventLog:System]
TRANSFORMS-WINEVENTLOG1 = WINLOG_set_host
[WinEventLog:Application]
TRANSFORMS-WINEVENTLOG1 = WINLOG_set_host
[WinEventLog:Application]
TRANSFORMS-WINEVENTLOG1 = WINLOG_set_host
[XmlWinEventLog:Microsoft-Windows-Sysmon/Operational]
TRANSFORMS-SYSMON1 = SYSMON_set_host


#
# Configuration stanzas EOL Logs
#
[exch:message_tracking]
BREAK_ONLY_BEFORE = RunspaceId
CHARSET =
DATETIME_CONFIG =
NO_BINARY_CHECK = true
TIME_PREFIX = Received         :
category = Custom
pulldown_type = true
REPORT-extract-headers = extract-headers


#
# Configuration stanzas frothly_custom
#
[access_combined]
EXTRACT-src ^(?<src_ip>[^\s]+)


#
# Configuration stanzas Splunk App for Azure
#
[ms:o365:management]
LOOKUP-useragentstrings = useragentstrings UserAgent AS UserAgent OUTPUTNEW browser_name AS browser_name os_name AS os_name os_version AS os_version ua_type AS ua_type


#
# Configuration stanzas Splunk Stream Add-on
#
[stream:dns]
FIELDALIAS-query_type = "query_type{}" as query_type
FIELDALIAS-name = "name{}" as name
FIELDALIAS-reply_code_id = "reply_code_id{}" as reply_code_id
FIELDALIAS-ttl = "ttl{}" as ttl
FIELDALIAS-host_addr = "host_addr{}" as host_addr
FIELDALIAS-host_type = "host_type{}" as host_type
FIELDALIAS-hostname = "hostname{}" as hostname
FIELDALIAS-reverse_addr = "reverse_addr{}" as reverse_addr

[stream:smb]
FIELDALIAS-dialect = "dialect{}" as dialect

[stream:smtp]
FIELDALIAS-content = "content{}" as content
FIELDALIAS-received_by_name = "received_by_name{}" as received_by_name
FIELDALIAS-receiver = "receiver{}" as receiver
FIELDALIAS-receiver_alias = "receiver_alias{}" as receiver_alias
FIELDALIAS-receiver_domain = "receiver_domain{}" as receiver_domain
FIELDALIAS-receiver_email = "receiver_email{}" as receiver_email
FIELDALIAS-receiver_rcpt_to = "receiver_rcpt_to{}" as receiver_rcpt_to
FIELDALIAS-receiver_type = "receiver_type{}" as receiver_type

[stream:tcp]
FIELDALIAS-ssl_client_cipher_list = "ssl_client_cipher_list{}" as ssl_client_cipher_list
FIELDALIAS-ssl_client_cipher_names = "ssl_client_cipher_names{}" as ssl_client_cipher_names
FIELDALIAS-ssl_client_compression_methods = "ssl_client_compression_methods{}" as ssl_client_compression_methods